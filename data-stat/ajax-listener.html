<!DOCTYPE html>
<html>
    <head>
        <meta charset="gbk" />
        <title>demo</title>
        <style type="text/css">
            body, form, h1, h2, h3, h4, p, img, ul, li, ol, dl, dt, dd, a, span, input, tr, th, td{margin:0;padding:0;}
		    body {font:normal 12px/1.5 "Arial","宋体","Simsun","Tahoma",sans-serif;}
		    li{list-style:none;}
		    img {border:0 none;vertical-align:top;}
		    table {border-collapse:collapse;border-spacing:0;}
            .cf:after{display:block;visibility:hidden;font-size:0;line-height:0;clear:both;content:"";}  
            .cf{zoom:1;}
		    a{color:#000;text-decoration:none;}
		    a:visited{}
		    a:hover{text-decoration:underline;}
		    a:active{}
            
            #J_Btn {
                display:block;
                width: 92px;
                height: 32px;
                line-height:32px;
                margin: 5px auto 10px;
                border-radius:3px;
                background: -webkit-gradient(linear, 50% 0%, 50% 100%, from(#3D97F1), to(#2B84DF));
                color: #fff;
                text-align:center;
                font-weight: bold;
                font-size: 14px;
            }
        </style>
        <script src="http://a.tbcdn.cn/s/kissy/1.1.6/kissy-min.js?t=20111231.js"></script>
    </head>
    <body>
        <a href="#" title="" id="J_Btn" data-stat="stat">点击请求</a>
         <div id="J_json" class="">
         
         </div>
    <script>
        
        var S = KISSY, D = S.DOM, E = S.Event;
        E.on('#J_Btn', 'click', function(e){
            S.io({
                type : 'GET',
                url : '/test/kissy/json.js?t='+S.now(),
                data : null,
                dataType : 'json',
                success : function(data){
                     processJson('#J_json',data);
                }
            })

            function processJson(container,data){
            	if(data.length > 0){
            		var arrHtml = [],_li = null,user;
            		//数据处理
            		S.each(data,function(item,i){
                        //if(i >= MAX ) return;
            			user = item["user"];
            			_li = "<li class='clearfix'><div class='user l'><img src='"+user['profile_image_url']+"' /><p>"+user["screen_name"]+"</p></div>"+item["text"]+"</li>";
            			arrHtml.push(_li);
            		});
            		//将生成的li添加到列表内
            		S.DOM.html(container,arrHtml.join(""));
            	}
            }
        });
    </script>
    <script>
        //function ajaxSend(objectOfXMLHttpRequest, callback) {  if(!callback){  return;  };  var s_ajaxListener = new Object();  s_ajaxListener.tempOpen = objectOfXMLHttpRequest.prototype.open;  s_ajaxListener.tempSend = objectOfXMLHttpRequest.prototype.send;  s_ajaxListener.callback = function () {  callback(this.method, this.url, this.data);  };  objectOfXMLHttpRequest.prototype.open = function(a,b) {  if (!a){ var a=''};  if (!b){ var b=''};  s_ajaxListener.tempOpen.apply(this, arguments);  s_ajaxListener.method = a;    s_ajaxListener.url = b;  if (a.toLowerCase() == 'get') {  s_ajaxListener.data = b.split('?');  s_ajaxListener.data = s_ajaxListener.data[1];  }  };  objectOfXMLHttpRequest.prototype.send = function(a,b) {  if (!a) var a='';  if (!b) var b='';  s_ajaxListener.tempSend.apply(this, arguments);  if(s_ajaxListener.method.toLowerCase() == 'post') {  s_ajaxListener.data = a;  }  s_ajaxListener.callback();  }  }; function onAjaxSend(method, url, data) {  console.log('onAjaxSend'); console.log(method); console.log(url); console.log(data); } ajaxSend(this.XMLHttpRequest, onAjaxSend); var target_arr = document.getElementsByTagName('a'); var flag = 1; if(target_arr.length){ for(var i = 0; i < target_arr.length; i++){ var stat = target_arr[i].getAttribute('data-stat'); if(stat && flag){ evt=document.createEvent('MouseEvents'); evt.initMouseEvent('click', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null); evt.preventDefault(); target_arr[i].dispatchEvent(evt); flag = 0; } } } 

        //(function (d) {
        //    var ta=d.createElement("script");ta.type="text/javascript";ta.async=true;
        //    ta.innerText="function ajaxSend(objectOfXMLHttpRequest, callback) {  if(!callback){  return;  };  var s_ajaxListener = new Object();  s_ajaxListener.tempOpen = objectOfXMLHttpRequest.prototype.open;  s_ajaxListener.tempSend = objectOfXMLHttpRequest.prototype.send;  s_ajaxListener.callback = function () {  callback(this.method, this.url, this.data);  };  objectOfXMLHttpRequest.prototype.open = function(a,b) {  if (!a){ var a=''};  if (!b){ var b=''};  s_ajaxListener.tempOpen.apply(this, arguments);  s_ajaxListener.method = a;    s_ajaxListener.url = b;  if (a.toLowerCase() == 'get') {  s_ajaxListener.data = b.split('?');  s_ajaxListener.data = s_ajaxListener.data[1];  }  };  objectOfXMLHttpRequest.prototype.send = function(a,b) {  if (!a) var a='';  if (!b) var b='';  s_ajaxListener.tempSend.apply(this, arguments);  if(s_ajaxListener.method.toLowerCase() == 'post') {  s_ajaxListener.data = a;  }  s_ajaxListener.callback();  }  }; function onAjaxSend(method, url, data) {  alert('onAjaxSend'); console.log(method); console.log(url); console.log(data); } ajaxSend(this.XMLHttpRequest, onAjaxSend); var target_arr = document.getElementsByTagName('a'); var flag = 1; if(target_arr.length){ for(var i = 0; i < target_arr.length; i++){ var stat = target_arr[i].getAttribute('data-stat'); if(stat && flag){ evt=document.createEvent('MouseEvents'); evt.initMouseEvent('click', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null); evt.preventDefault(); target_arr[i].dispatchEvent(evt); flag = 0; } } }";
        //    d.getElementsByTagName("body")[0].appendChild(ta);
        //})(document);

        //function ajaxSend(objectOfXMLHttpRequest, callback) {  
        //    if(!callback){  
        //        return;  
        //    }  
        //      
        //    var s_ajaxListener = new Object();  
        //    s_ajaxListener.tempOpen = objectOfXMLHttpRequest.prototype.open;  
        //    s_ajaxListener.tempSend = objectOfXMLHttpRequest.prototype.send;  
        //    s_ajaxListener.callback = function () {  
        //        callback(this.method, this.url, this.data);  
        //    }  
        //      
        //    objectOfXMLHttpRequest.prototype.open = function(a,b) {  
        //        if (!a) var a='';  
        //        if (!b) var b='';  
        //        s_ajaxListener.tempOpen.apply(this, arguments);  
        //        s_ajaxListener.method = a;    
        //        s_ajaxListener.url = b;  
        //        if (a.toLowerCase() == 'get') {  
        //            s_ajaxListener.data = b.split('?');  
        //            s_ajaxListener.data = s_ajaxListener.data[1];  
        //        }  
        //    }  
        //      
        //    objectOfXMLHttpRequest.prototype.send = function(a,b) {  
        //        if (!a) var a='';  
        //        if (!b) var b='';  
        //        s_ajaxListener.tempSend.apply(this, arguments);  
        //        if(s_ajaxListener.method.toLowerCase() == 'post') {  
        //            s_ajaxListener.data = a;  
        //        }  
        //        s_ajaxListener.callback();  
        //    }  
        //}  

        //function onAjaxSend(method, url, data) {  
        //    console.log('onAjaxSend');
        //    console.log(method);
        //    console.log(url);
        //    console.log(data);
        //} 

        //ajaxSend(this.XMLHttpRequest, onAjaxSend);

        //var target_arr = document.getElementsByTagName('a');
        //var flag = 1; 
        //if(target_arr.length){ 
        //    for(var i = 0; i < target_arr.length; i++){
        //        var stat = target_arr[i].getAttribute('data-stat'); 
        //        if(stat && flag){
        //            evt=document.createEvent('MouseEvents'); 
        //            evt.initMouseEvent('click', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null); 
        //            evt.preventDefault();
        //            target_arr[i].dispatchEvent(evt);
        //            flag = 0; 
        //        } 
        //    } 
        //}
    </script>
    </body>
</html>
